---
import Layout from './Layout.astro';
import Navigation from '../components/Navigation.astro';
import Comments from '../components/Comments.astro';
import { format } from 'date-fns';
import type { CollectionEntry } from 'astro:content';

type Props = CollectionEntry<'blog'>['data'] & {
	slug: string;
};

const { title, description, pubDate, updatedDate, heroImage, slug } = Astro.props;
---

<Layout title={title} description={description}>
	<Navigation />
	<article class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 pt-28 pb-16">
		<header class="mb-10">
			<h1 class="text-3xl font-bold tracking-tight sm:text-4xl text-zinc-900 dark:text-zinc-50">
				{title}
			</h1>
			{heroImage && (
				<img
					src={heroImage}
					alt={`Hero image for ${title}`}
					class="rounded-xl shadow-md mt-6 w-full"
				/>
			)}
			<div class="flex items-center text-sm text-zinc-500 dark:text-zinc-400 mt-4">
				<time datetime={pubDate.toISOString()}>
					{format(pubDate, 'MMMM d, yyyy')}
				</time>
				{updatedDate && (
					<>
						<span class="mx-2">·</span>
						<span>Updated {format(updatedDate, 'MMMM d, yyyy')}</span>
					</>
				)}
			</div>
		</header>

		<div class="prose prose-lg prose-purple dark:prose-invert prose-headings:tracking-tight prose-p:leading-relaxed prose-pre:bg-[#1a1b26] prose-img:rounded-lg max-w-none">
			<slot />
		</div>

		<footer class="mt-16 pt-8 border-t border-zinc-200 dark:border-zinc-800">
			<a
				href="/blog"
				class="text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 transition-colors"
			>
				← Back to Blog
			</a>
		</footer>

		<Comments />
	</article>
</Layout>

<style>
	.prose :global(code:not(pre code)) {
		color: #7c3aed;
		background-color: #f3f4f6;
		padding: 0.15rem 0.35rem;
		border-radius: 0.25rem;
		font-size: 0.85em;
	}
	:global(.dark) .prose :global(code:not(pre code)) {
		background-color: #374151;
		color: #a78bfa;
	}
	.prose :global(pre code) {
		color: inherit;
		background-color: transparent;
		padding: 0;
	}
</style>
