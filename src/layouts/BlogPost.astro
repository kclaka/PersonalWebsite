---
import Layout from './Layout.astro';
import Navigation from '../components/Navigation.astro';
import Comments from '../components/Comments.astro';
import { format } from 'date-fns';
import type { CollectionEntry } from 'astro:content';

type Props = CollectionEntry<'blog'>['data'] & {
	slug: string;
};

const { title, description, pubDate, updatedDate, heroImage, slug } = Astro.props;
---

<Layout title={title} description={description} type="article" publishedTime={pubDate} modifiedTime={updatedDate}>
	<Navigation />
	<article class="max-w-2xl mx-auto px-4 sm:px-6 pb-16">
		<header class="mt-8 mb-10">
			<h1 class="text-2xl font-bold tracking-tight sm:text-3xl text-zinc-900 dark:text-zinc-100">
				{title}
			</h1>
			{heroImage && (
				<img
					src={heroImage}
					alt={`Hero image for ${title}`}
					class="rounded-lg mt-6 w-full"
				/>
			)}
			<div class="flex items-center text-sm text-zinc-500 dark:text-zinc-400 mt-4">
				<time datetime={pubDate.toISOString()}>
					{format(pubDate, 'MMMM d, yyyy')}
				</time>
				{updatedDate && (
					<>
						<span class="mx-2">&middot;</span>
						<span>Updated {format(updatedDate, 'MMMM d, yyyy')}</span>
					</>
				)}
			</div>
		</header>

		<div class="prose prose-lg dark:prose-invert prose-headings:tracking-tight prose-p:leading-relaxed prose-pre:bg-[#1a1b26] prose-img:rounded-lg max-w-none">
			<slot />
		</div>

		<footer class="mt-16 pt-8 border-t border-zinc-200 dark:border-zinc-800">
			<a
				href="/blog"
				class="text-sm text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100"
			>
				&larr; Back to Blog
			</a>
		</footer>

		<Comments />
	</article>
</Layout>

<style>
	.prose :global(code:not(pre code)) {
		color: #374151;
		background-color: #f3f4f6;
		padding: 0.15rem 0.35rem;
		border-radius: 0.25rem;
		font-size: 0.85em;
	}
	:global(.dark) .prose :global(code:not(pre code)) {
		background-color: #374151;
		color: #d1d5db;
	}
	.prose :global(pre code) {
		color: inherit;
		background-color: transparent;
		padding: 0;
	}
</style>
